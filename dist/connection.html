<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="assets/css/main.css">
    <title>Document</title>
</head>
<body>
<div class="transition">
    <h4><a href="index.html">Главная</a></h4>
    <h2 class="title-two">ОБРАТНАЯ СВЯЗЬ</h2>
</div>
<header class="header">
  <input type="checkbox" id="burger-toggle" class="burger-toggle">
  <label for="burger-toggle" class="burger-btn">
    <span class="burger-line"></span>
    <span class="burger-line"></span>
    <span class="burger-line"></span>
  </label>

  <nav class="nav">
    <ul class="menu">
      <li class="menu-item">
        <a href="#" class="menu-link">МЕТОДИЧЕСКОЕ ПОРТФОЛИО</a>
        <ul class="submenu">
          <li><a href="norm-docum.html">Нормативно-правовая документация</a></li>
          <li><a href="literature.html">Методическая литература</a></li>
          <li><a href="documentation.html">Материалы основной деятельности</a></li>
          <li><a href="developments.html">Методические разработки</a></li>
        </ul>
      </li>

      <li class="menu-item">
        <a href="#" class="menu-link">ИНФОРМАЦИЯ</a>
        <ul class="submenu">
          <li><a href="parents.html">Для родителей</a></li>
          <li><a href="teachers.html">Для классных руководителей</a></li>
          <li><a href="students.html">Для обучающихся</a></li>
        </ul>
      </li>

      <li class="menu-item">
        <a href="achievements.html" class="menu-link">ДОСТИЖЕНИЯ</a>
      </li>

      <li class="menu-item">
        <a href="connection.html" class="menu-link">ОБРАТНАЯ СВЯЗЬ</a>
      </li>

      <li class="menu-item">
        <a href="blog.html" class="menu-link">БЛОГ</a>
      </li>
    </ul>
  </nav>
</header>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Комментарии к мероприятию</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="comments.scss">
</head>
<body>
<div class="container">
    <h1>КОММЕНТАРИИ</h1>
</div>
<div class="container">
    <form id="commentForm" class="comment-form">
        <div class="form-group">
            <label for="userName" class="form-label">Ваше имя:</label>
            <input type="text" id="userName" name="name" class="form-input" placeholder="Как вас зовут?" required>
        </div>

        <div class="form-group">
            <label for="userComment" class="form-label">Ваш комментарий:</label>
            <textarea id="userComment" name="comment" class="form-textarea" placeholder="Поделитесь впечатлениями о сайте..." maxlength="500" required></textarea>
            <div id="charCounter" class="char-count">0/500</div>
        </div>

        <button type="submit" class="submit-btn">
            <span class="btn-text">Отправить комментарий</span>
        </button>
    </form>

    <section class="comments-section">
        <h3 class="comments-subtitle">Последние комментарии</h3>
        <div class="comments-list" id="commentsContainer">
            
            <div class="no-comments">Пока нет комментариев. Оставьте первый!</div>
        </div>
    </section>
</div>

<script src="comments.js"></script>
</body>
</html>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Элементы DOM
        const form = document.getElementById('commentForm');
        const commentInput = document.getElementById('userComment');
        const charCounter = document.getElementById('charCounter');
        const commentsContainer = document.getElementById('commentsContainer');

        // Инициализация
        loadComments();
        updateCharCounter();

        // События
        commentInput.addEventListener('input', updateCharCounter);
        form.addEventListener('submit', handleSubmit);

        // Функции
        function updateCharCounter() {
            const length = commentInput.value.length;
            charCounter.textContent = `${length}/500`;
            charCounter.className = `char-count${length > 450 ? ' warning' : length >= 500 ? ' error' : ''}`;
        }

        function handleSubmit(event) {
            event.preventDefault();

            const formData = new FormData(form);
            const name = formData.get('name').trim();
            const comment = formData.get('comment').trim();

            if (!validateForm(name, comment)) return;

            const newComment = createComment(name, comment);

            saveToStorage(newComment);
            displayComment(newComment);
            resetForm();
            scrollToComment();
        }

        function validateForm(name, comment) {
            if (!comment) {
                alert('Пожалуйста, напишите комментарий');
                commentInput.focus();
                return false;
            }
            return true;
        }

        function createComment(name, text) {
            return {
                id: Date.now(),
                name: name || 'Аноним',
                text: text,
                date: formatDate(new Date())
            };
        }

        function formatDate(date) {
            return date.toLocaleString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function saveToStorage(comment) {
            const comments = getCommentsFromStorage();
            comments.unshift(comment);
            localStorage.setItem('eventComments', JSON.stringify(comments));
        }

        function getCommentsFromStorage() {
            return JSON.parse(localStorage.getItem('eventComments') || '[]');
        }

        function loadComments() {
            const comments = getCommentsFromStorage();

            if (comments.length === 0) return;

            commentsContainer.innerHTML = '';
            comments.forEach(displayComment);
        }

        function displayComment(comment) {
            // Удаляем сообщение "нет комментариев" при первом комментарии
            const noComments = commentsContainer.querySelector('.no-comments');
            if (noComments) noComments.remove();

            const commentElement = createCommentElement(comment);
            commentsContainer.prepend(commentElement);
        }

        function createCommentElement(comment) {
            const div = document.createElement('div');
            div.className = 'comment';
            div.innerHTML = `
            <div class="comment-header">
                <span class="comment-author">${escapeHtml(comment.name)}</span>
                <span class="comment-date">${comment.date}</span>
            </div>
            <div class="comment-text">${escapeHtml(comment.text)}</div>
        `;
            return div;
        }

        function resetForm() {
            form.reset();
            updateCharCounter();
        }

        function scrollToComment() {
            const firstComment = document.querySelector('.comment');
            if (firstComment) {
                firstComment.scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    });
</script>
<footer>
  <p>©2025 Dolgova</p>
</footer>
</body>
</html>
